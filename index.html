<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NR7C688Z');</script>
<!-- End Google Tag Manager -->
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>VCB â€” Viable Core Business</title>
<link rel="icon" type="image/jpeg" href="https://i.postimg.cc/CKDGzk0c/VCBWhite.jpg">
<link rel="apple-touch-icon" href="https://i.postimg.cc/CKDGzk0c/VCBWhite.jpg">

<!-- Quicksand: 400, 500, 600, 700 (enhanced readability) -->
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
  :root{
    --black:#0B0B0B;
    --g-900:#111; --g-800:#1A1A1A; --g-700:#2A2A2A; --g-600:#3D3D3D;
    --g-500:#565656; --g-400:#777; --g-300:#9A9A9A; --g-200:#D5D5D5; --g-100:#EFEFEF;
    --white:#fff;
    --max:1200px; --radius:18px;
    --shadow:0 4px 24px rgba(0,0,0,.06), 0 12px 48px rgba(0,0,0,.04);
    --shadow-lg:0 8px 32px rgba(0,0,0,.08), 0 20px 64px rgba(0,0,0,.06);
    --glow:0 0 0 1px rgba(0,0,0,.04), 0 10px 30px rgba(0,0,0,.08);
  }
  *{box-sizing:border-box}
  html{
    background:var(--white);
  }
  body{
    margin:0; background:transparent; color:var(--g-900);
    font-family:"Quicksand", system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    font-weight:400; line-height:1.65; -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    text-rendering:optimizeLegibility;
    scroll-behavior:smooth;
  }
  h1,h2,h3,h4{ font-weight:600; color:var(--black); margin:0 0 .6rem; letter-spacing:-.015em; text-rendering:optimizeLegibility; -webkit-font-smoothing:antialiased; }
  h1{ font-size:clamp(42px,5.6vw,72px); line-height:1.05; letter-spacing:-.02em; font-weight:700; }
  h2{ font-size:clamp(28px,3.6vw,42px); letter-spacing:-.01em; margin-bottom:1rem; font-weight:600; }
  h3{ font-size:clamp(20px,2.4vw,26px); color:var(--g-800); letter-spacing:-.005em; font-weight:600; }
  p{ margin:.45rem 0 1rem; color:var(--g-700); font-weight:400; }
  ul{ margin:.25rem 0 1rem 1.1rem; padding:0; }
  li{ margin:.25rem 0; color:var(--g-800); font-weight:400; }
  .wrap{ max-width:var(--max); margin:0 auto; padding:0 20px; }
  .section{ padding:96px 0; position:relative; }
  .section:not(:last-child)::after{
    content:"; position:absolute; bottom:0; left:50%; transform:translateX(-50%);
    width:80%; max-width:600px; height:1px;
    background:linear-gradient(90deg, transparent, rgba(0,0,0,.08), transparent);
  }
  .divider{ height:1px; background:linear-gradient(90deg,transparent,rgba(0,0,0,.1),transparent); margin:32px 0; border:0; }

  /* Particle background iframe */
  #particle-bg{
    position:fixed; inset:0; z-index:-3; pointer-events:none;
    width:100%; height:100%; border:0; background:transparent;
  }

  /* Subtle animated GRID background */
  body::before{
    content:"; position:fixed; inset:0; z-index:-2; pointer-events:none;
    background:
      repeating-linear-gradient(0deg, rgba(0,0,0,.03) 0 1px, transparent 1px 48px),
      repeating-linear-gradient(90deg, rgba(0,0,0,.03) 0 1px, transparent 1px 48px);
    transform:translateZ(0);
    animation:gridFloat 32s linear infinite;
  }
  @keyframes gridFloat{ to{ transform:translate3d(-48px,-48px,0); } }

  /* Sticky glass NAV with wire mesh */
  .top{
    position:sticky; top:0; z-index:1000; overflow:visible;
    background:rgba(255,255,255,0.95);
    -webkit-backdrop-filter:blur(10px); backdrop-filter:blur(10px);
    border-bottom:1px solid rgba(239,239,239,0.8);
  }
  #mesh-canvas{
    position:absolute; inset:0; z-index:-1; pointer-events:none; opacity:0.2;
    width:100%; height:100%;
  }
  .nav{ display:flex; align-items:center; justify-content:space-between; padding:8px 0; }
  .nav nav{ overflow:visible; }
  .brand{ display:flex; align-items:center; }
  .brand img{ height:240px; width:auto; mix-blend-mode:multiply; }
  .nav nav a{
    color:var(--g-700); text-decoration:none; margin-left:16px; position:relative; padding:4px 2px;
    font-size:2em; font-weight:700;
    transition:transform .2s ease, color .2s ease;
    text-rendering:optimizeLegibility;
  }
  .nav nav a::after{
    content:"; position:absolute; left:0; right:0; bottom:-4px; height:2px; background:var(--g-200);
    transform:scaleX(0); transform-origin:right; transition:transform .35s ease;
  }
  .nav nav a:hover{ color:var(--black); transform:scale(0.95); }
  .nav nav a:hover::after{ transform:scaleX(1); transform-origin:left; }

  /* Dropdown Menu Styles */
  .nav nav .dropdown{
    position:relative;
    display:inline-block;
    margin-left:16px;
  }
  .nav nav .dropdown > a{
    margin-left:0;
    cursor:pointer;
  }
  .nav nav .dropdown-content{
    display:none;
    position:absolute;
    top:100%;
    left:0;
    min-width:220px;
    background:rgba(255,255,255,0.98);
    -webkit-backdrop-filter:blur(12px);
    backdrop-filter:blur(12px);
    border:1px solid rgba(0,0,0,.08);
    border-radius:12px;
    box-shadow:0 8px 32px rgba(0,0,0,.12), 0 16px 64px rgba(0,0,0,.08);
    padding:8px 0;
    margin-top:8px;
    z-index:1001;
  }
  .nav nav .dropdown:hover .dropdown-content{
    display:block;
    animation:dropdownFadeIn 0.3s ease;
  }
  @keyframes dropdownFadeIn{
    from{
      opacity:0;
      transform:translateY(-8px);
    }
    to{
      opacity:1;
      transform:translateY(0);
    }
  }
  .nav nav .dropdown-content a{
    display:block;
    margin:0;
    padding:12px 20px;
    font-size:1em;
    font-weight:600;
    color:var(--g-700);
    text-decoration:none;
    transition:all .2s ease;
  }
  .nav nav .dropdown-content a::after{
    display:none;
  }
  .nav nav .dropdown-content a:hover{
    background:linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%);
    color:var(--black);
    transform:translateX(4px);
  }

  /* Meet VCB Seal Button */
  .meet-vcb-seal{
    position:relative;
    display:inline-flex;
    align-items:center;
    gap:8px;
    margin-left:20px;
    padding:10px 20px;
    background:linear-gradient(135deg, var(--black) 0%, var(--g-700) 100%);
    border:2px solid var(--g-200);
    border-radius:999px;
    color:var(--white);
    font-family:"Quicksand", sans-serif;
    font-size:0.95em;
    font-weight:600;
    cursor:pointer;
    transition:all .3s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow:0 4px 12px rgba(11,11,11,.2), 0 0 0 0 rgba(11,11,11,.1);
    overflow:hidden;
  }
  .meet-vcb-seal::before{
    content:"";
    position:absolute;
    inset:-2px;
    border-radius:999px;
    background:conic-gradient(from 0deg, var(--black), var(--g-600), var(--black));
    z-index:-1;
    opacity:0;
    transition:opacity .4s ease;
    animation:rotateSeal 3s linear infinite;
  }
  .meet-vcb-seal:hover::before{
    opacity:1;
  }
  @keyframes rotateSeal{
    to{ transform:rotate(360deg); }
  }
  .meet-vcb-seal:hover{
    transform:translateY(-2px) scale(1.05);
    box-shadow:0 8px 24px rgba(11,11,11,.3), 0 0 0 4px rgba(11,11,11,.08);
    border-color:var(--white);
  }
  .meet-vcb-seal svg{
    width:18px;
    height:18px;
    fill:var(--white);
    stroke:none;
    transition:transform .3s ease;
  }
  .meet-vcb-seal:hover svg{
    transform:rotate(20deg) scale(1.1);
  }
  .meet-vcb-seal span{
    position:relative;
    z-index:1;
  }
  @media(max-width:1024px){
    .meet-vcb-seal{
      padding:8px 16px;
      font-size:0.85em;
      gap:6px;
    }
    .meet-vcb-seal svg{
      width:16px;
      height:16px;
    }
  }
  @media(max-width:768px){
    .meet-vcb-seal{
      margin-left:12px;
      padding:6px 12px;
      font-size:0.75em;
    }
    .meet-vcb-seal svg{
      width:14px;
      height:14px;
    }
  }

  /* Compliance Callout Banner */
  .compliance-banner{
    background:linear-gradient(135deg, rgba(248,249,250,.8) 0%, rgba(233,236,239,.6) 100%);
    border-bottom:1px solid rgba(0,0,0,.06);
    padding:32px 0;
    text-align:center;
    -webkit-backdrop-filter:blur(8px); backdrop-filter:blur(8px);
    position:relative;
    min-height:120px;
    display:flex;
    align-items:center;
  }
  .compliance-banner::before{
    content:"; position:absolute; inset:0;
    background:radial-gradient(ellipse at center, rgba(0,0,0,.02) 0%, transparent 70%);
    pointer-events:none;
  }
  .compliance-banner p{
    font-style:italic; color:var(--g-700); max-width:1000px; margin:0 auto;
    font-size:clamp(16px, 2vw, 19px); line-height:1.7;
    font-weight:400; letter-spacing:.2px;
    transition:opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    position:relative;
  }
  .compliance-banner p.fade-out{
    opacity:0;
  }

  /* Exclusive Event Banner */
  .event-exclusive{
    background:linear-gradient(135deg, #0B0B0B 0%, #1A1A1A 100%);
    border-top:2px solid #D4AF37;
    border-bottom:2px solid #D4AF37;
    padding:64px 0;
    position:relative;
    overflow:hidden;
  }
  .event-exclusive::before{
    content:"; position:absolute; inset:0;
    background:radial-gradient(ellipse at center, rgba(212,175,55,.12) 0%, transparent 70%);
    pointer-events:none;
  }
  .event-exclusive .wrap{ position:relative; z-index:1; text-align:center; }
  .event-exclusive .exclusive-tag{
    display:inline-block; padding:6px 16px; border-radius:999px;
    background:linear-gradient(135deg, #D4AF37 0%, #B8942D 100%);
    color:#0B0B0B; font-weight:700; font-size:11px; letter-spacing:2px;
    text-transform:uppercase; margin-bottom:16px;
    box-shadow:0 4px 20px rgba(212,175,55,.4);
  }
  .event-exclusive h2{
    background:linear-gradient(135deg, #D4AF37 0%, #fff 100%);
    -webkit-background-clip:text; -webkit-text-fill-color:transparent;
    background-clip:text;
    font-size:clamp(32px,4.2vw,52px); font-weight:600; margin-bottom:16px;
  }
  .event-exclusive p{
    color:#D5D5D5; max-width:700px; margin:0 auto 32px;
    font-size:clamp(15px,1.8vw,18px); line-height:1.6;
  }
  .event-exclusive .btn-gold{
    display:inline-block;
    border:2px solid #D4AF37; color:#D4AF37;
    text-decoration:none;
    padding:16px 40px; border-radius:14px; font-weight:600; font-size:16px;
    background:linear-gradient(135deg, rgba(212,175,55,.15) 0%, rgba(184,148,45,.08) 100%);
    box-shadow:0 6px 24px rgba(212,175,55,.25);
    transition:all .4s cubic-bezier(0.4, 0, 0.2, 1);
    position:relative; overflow:hidden; z-index:1;
    text-transform:uppercase; letter-spacing:1.2px;
  }
  .event-exclusive .btn-gold::before{
    content:"; position:absolute; inset:0; background:#D4AF37;
    transform:translateY(100%); transition:transform .4s cubic-bezier(0.4, 0, 0.2, 1);
    z-index:-1;
  }
  .event-exclusive .btn-gold:hover{
    color:#0B0B0B; transform:translateY(-3px) scale(1.02);
    box-shadow:0 12px 40px rgba(212,175,55,.4);
  }
  .event-exclusive .btn-gold:hover::before{ transform:translateY(0); }
  .event-exclusive .event-meta{
    margin-top:24px; color:#9A9A9A; font-size:14px; letter-spacing:.5px;
  }

  /* HERO */
  .hero{
    position:relative; overflow:hidden; padding:120px 0 80px;
    background:linear-gradient(180deg, rgba(255,255,255,0) 0%, rgba(250,250,250,.4) 100%);
  }
  .hero h1{
    background:linear-gradient(135deg, var(--black) 0%, var(--g-700) 100%);
    -webkit-background-clip:text; -webkit-text-fill-color:transparent;
    background-clip:text;
  }
  .lede{ color:var(--g-600); max-width:940px; font-size:clamp(16px, 2vw, 19px); line-height:1.7; font-weight:400; }

  /* Badges & CTA */
  .badges{ display:flex; flex-wrap:wrap; gap:12px; margin-top:24px; }
  .badge{
    border:1px solid rgba(0,0,0,.08); color:var(--g-800);
    background:linear-gradient(135deg, #fff 0%, #fafafa 100%);
    border-radius:999px; padding:10px 18px; font-size:13px;
    box-shadow:0 2px 8px rgba(0,0,0,.04), 0 4px 16px rgba(0,0,0,.02);
    font-weight:500; letter-spacing:.3px;
    transition:all .3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  .badge:hover{
    transform:translateY(-3px) scale(1.05);
    box-shadow:0 6px 20px rgba(0,0,0,.12), 0 0 0 1px rgba(11,11,11,.1), 0 0 16px rgba(11,11,11,.04);
    border-color:rgba(0,0,0,.15);
  }
  .cta-row{ margin-top:28px; display:flex; gap:16px; flex-wrap:wrap; }
  .btn{
    display:inline-block;
    border:2px solid var(--g-800);
    color:var(--g-800);
    text-decoration:none;
    padding:14px 28px;
    border-radius:14px;
    font-weight:600;
    font-size:15px;
    background:linear-gradient(135deg, #fff 0%, #fafafa 100%);
    box-shadow:0 2px 12px rgba(0,0,0,.05), 0 4px 24px rgba(0,0,0,.03);
    transition:all .4s cubic-bezier(0.4, 0, 0.2, 1);
    text-rendering:optimizeLegibility;
  }
  .btn:hover{
    color:var(--white) !important;
    background:var(--black);
    transform:translateY(-3px);
    box-shadow:0 8px 28px rgba(0,0,0,.15), 0 16px 56px rgba(0,0,0,.1);
    border-color:var(--black);
  }

  /* GRID & CARDS */
  .grid-2{ display:grid; gap:28px; grid-template-columns:1fr; }
  .grid-3{ display:grid; gap:28px; grid-template-columns:1fr; }
  .grid-4{ display:grid; gap:20px; grid-template-columns:1fr; }
  @media(min-width:900px){
    .grid-2{ grid-template-columns:1fr 1fr; }
    .grid-3{ grid-template-columns:repeat(3,1fr); }
    .grid-4{ grid-template-columns:repeat(4,1fr); }
  }
  .card{
    position:relative;
    background:linear-gradient(135deg, #fff 0%, #fafafa 100%);
    border:1px solid rgba(0,0,0,.06);
    border-radius:var(--radius);
    padding:32px;
    box-shadow:var(--shadow);
    transform:translateZ(0);
    transition:all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    -webkit-backdrop-filter:blur(8px); backdrop-filter:blur(8px);
    overflow:hidden;
  }
  .card::before{
    content:";
    position:absolute;
    inset:-1px;
    border-radius:calc(var(--radius) + 1px);
    background:conic-gradient(from 120deg, rgba(11,11,11,.12), rgba(42,42,42,0), rgba(11,11,11,.12));
    z-index:-1;
    opacity:0;
    transition:opacity .5s ease;
  }
  .card::after{
    content:";
    position:absolute;
    inset:0;
    border-radius:var(--radius);
    background:linear-gradient(135deg, rgba(255,255,255,.9) 0%, rgba(245,245,245,.3) 100%);
    opacity:0;
    transition:opacity .5s ease;
    pointer-events:none;
  }
  .card:hover::before{
    opacity:1;
    animation:rotateGlow 3s linear infinite;
  }
  @keyframes rotateGlow{
    to{ transform:rotate(360deg); }
  }
  .card:hover::after{ opacity:.4; }
  .card:hover{
    transform:translateY(-18px) scale(1.025);
    box-shadow:0 16px 48px rgba(0,0,0,.14), 0 32px 96px rgba(0,0,0,.1), 0 0 0 1px rgba(11,11,11,.12), 0 0 24px rgba(11,11,11,.06);
    border-color:rgba(11,11,11,.18);
  }

  /* ICONS */
  .tile{ display:grid; gap:12px; align-content:start; }
  .tile .head{ display:flex; align-items:center; gap:12px; }
  .icon{ width:30px; height:30px; stroke:var(--g-700); stroke-width:1.8; fill:none; transition:all .35s cubic-bezier(0.4, 0, 0.2, 1); }
  .card:hover .icon,
  .tile:hover .icon{ transform:scale(1.12) rotate(5deg); filter:drop-shadow(0 6px 12px rgba(0,0,0,.12)); }

  /* STAT TILES */
  .stats{ display:grid; gap:18px; grid-template-columns:1fr 1fr; margin-top:20px; }
  @media(min-width:900px){ .stats{ grid-template-columns:repeat(4,1fr); } }
  .stat{
    background:linear-gradient(180deg,#fff,#FAFAFA); border:1px solid var(--g-100); border-radius:18px;
    padding:22px; text-align:center; box-shadow:var(--shadow);
  }
  .stat .n{ font-size:clamp(30px,3.8vw,48px); font-weight:500; color:var(--black); line-height:1.04; letter-spacing:.2px; }
  .stat .l{ color:var(--g-600); font-size:.95rem; margin-top:6px; }

  /* LANES */
  .lane{ display:grid; gap:14px; grid-template-columns:40px 1fr; align-items:flex-start; }
  .lanetag{ width:40px; height:40px; border-radius:12px; border:1px solid var(--g-200);
            display:grid; place-items:center; background:#fff; box-shadow:var(--glow); }
  .lanetag .icon{ width:22px; height:22px; }

  /* TEAM */
  .person{
    display:grid; grid-template-columns:72px 1fr; gap:16px; align-items:center;
    border:1px solid var(--g-100); border-radius:var(--radius); padding:18px; background:#fff; box-shadow:var(--shadow);
  }
  .avatar{
    width:72px; height:72px; border-radius:50%; display:grid; place-items:center;
    border:2px solid var(--g-200); background:linear-gradient(180deg,#fff,#FAFAFA); color:var(--black); font-weight:500;
  }
  .meta{ font-size:13px; color:var(--g-500); }
  .li-badge{ margin-top:10px; }
  .LI-profile-badge{ width:100%; }
  @media (max-width:520px){ .person{ grid-template-columns:1fr; } .avatar{ margin-bottom:8px; } }

  /* Skill timelines */
  .timeline{ display:grid; gap:12px; }
  .trow{ display:grid; grid-template-columns:140px 1fr; gap:12px; }
  .trow .label{ color:var(--g-600); font-size:13px; white-space:nowrap; }
  .bar{ position:relative; height:10px; background:var(--g-100); border-radius:999px; overflow:hidden; }
  .bar i{ position:absolute; left:0; top:0; bottom:0; width:60%; background:var(--g-700); }

  /* Reveal on scroll */
  .reveal{
    opacity:0; transform:translateY(40px);
    transition:opacity .8s cubic-bezier(0.4, 0, 0.2, 1), transform .8s cubic-bezier(0.4, 0, 0.2, 1);
  }
  .reveal.in{ opacity:1; transform:none; }
  .reveal:nth-child(1){ transition-delay:.05s; }
  .reveal:nth-child(2){ transition-delay:.1s; }
  .reveal:nth-child(3){ transition-delay:.15s; }
  .reveal:nth-child(4){ transition-delay:.2s; }
  .reveal:nth-child(5){ transition-delay:.25s; }
  .reveal:nth-child(6){ transition-delay:.3s; }

  /* Footer */
  footer{ border-top:1px solid var(--g-100); color:var(--g-400); font-size:14px; text-align:center; padding:30px 0 44px; }

  @media (prefers-reduced-motion:reduce){
    .card:hover{ transform:none; box-shadow:var(--shadow); }
    .reveal{ opacity:1; transform:none; }
    body::before{ animation:none; }
  }

  /* Mobile Optimization */
  @media(max-width:768px){
    .wrap{ padding:0 16px; }

    /* Smaller logo for mobile */
    .brand img{ height:120px; }

    /* Mobile nav - stack or reduce size */
    .nav{ padding:6px 0; flex-wrap:wrap; gap:8px; }
    .nav nav{
      display:flex;
      flex-wrap:wrap;
      justify-content:center;
      width:100%;
    }
    .nav nav a{
      font-size:0.85em;
      margin-left:8px;
      margin-right:8px;
    }

    /* Compliance banner mobile */
    .compliance-banner{ padding:20px 0; }
    .compliance-banner p{ font-size:14px; line-height:1.5; }

    /* Event banner mobile */
    .event-exclusive{ padding:40px 0; }
    .event-exclusive .exclusive-tag{ font-size:10px; padding:5px 12px; }
    .event-exclusive h2{ font-size:clamp(24px,6vw,36px); }
    .event-exclusive p{ font-size:14px; }
    .event-exclusive .btn-gold{
      padding:12px 28px;
      font-size:14px;
      display:block;
      max-width:280px;
      margin:0 auto;
    }
    .event-exclusive .event-meta{ font-size:12px; }

    /* Hero adjustments */
    .hero{ padding:60px 0 40px; }
    h1{ font-size:clamp(28px,7vw,42px); }
    h2{ font-size:clamp(22px,5vw,32px); }
    h3{ font-size:clamp(18px,4vw,24px); }

    /* Reduce section padding */
    .section{ padding:48px 0; }

    /* Smaller card padding */
    .card{ padding:20px; }

    /* Badges wrap better */
    .badges{ gap:8px; }
    .badge{ font-size:12px; padding:8px 14px; }

    /* Stats adjustments */
    .stats{ gap:12px; grid-template-columns:1fr 1fr; }
    .stat{ padding:16px; }
    .stat .n{ font-size:clamp(24px,5vw,36px); }
    .stat .l{ font-size:0.85rem; }

    /* CTA buttons */
    .btn{
      font-size:14px;
      padding:12px 20px;
    }
    .cta-row{ justify-content:center; }

    /* Tile icons smaller */
    .icon{ width:24px; height:24px; }

    /* Lane adjustments */
    .lane{ grid-template-columns:32px 1fr; gap:10px; }
    .lanetag{ width:32px; height:32px; }
    .lanetag .icon{ width:18px; height:18px; }

    /* Disable hover effects on mobile */
    .card:hover{
      transform:none;
      box-shadow:var(--shadow);
    }
    .badge:hover{
      transform:none;
      box-shadow:0 2px 8px rgba(0,0,0,.04), 0 4px 16px rgba(0,0,0,.02);
    }
    .btn:hover{
      transform:none;
      box-shadow:0 2px 12px rgba(0,0,0,.05), 0 4px 24px rgba(0,0,0,.03);
    }

    /* Better list spacing */
    ul{ margin-left:0.8rem; }
    li{ font-size:15px; }

    /* Hide mesh canvas on mobile for performance */
    #mesh-canvas{ display:none; }

    /* Disable grid animation on mobile for performance */
    body::before{ animation:none; }
  }

  /* Extra small mobile */
  @media(max-width:480px){
    .brand img{ height:90px; }

    .nav nav a{
      font-size:0.75em;
      margin-left:6px;
      margin-right:6px;
    }

    h1{ font-size:clamp(24px,8vw,36px); }
    h2{ font-size:clamp(20px,6vw,28px); }

    .card{ padding:16px; }

    .event-exclusive{ padding:32px 0; }
    .event-exclusive h2{ font-size:clamp(20px,7vw,32px); }
    .event-exclusive .btn-gold{ padding:10px 24px; font-size:13px; }

    .stats{ grid-template-columns:1fr; }
    .stat .n{ font-size:clamp(28px,6vw,40px); }

    .compliance-banner p{ font-size:13px; }
  }

  /* Video Modal - VCB Introduction */
  .video-modal{
    display:none;
    position:fixed;
    top:0; left:0; right:0; bottom:0;
    background:transparent;
    z-index:10001;
    align-items:center;
    justify-content:center;
    animation:modalFadeIn .5s ease;
    pointer-events:none;
  }
  .video-modal.active{
    display:flex;
  }
  .video-modal-content{
    position:relative;
    width:auto;
    height:auto;
    max-width:none;
    max-height:80vh;
    background:transparent;
    border-radius:0;
    overflow:hidden;
    pointer-events:auto;
    cursor:-webkit-grab;
    cursor:grab;
    touch-action:none; /* enable touch dragging without scrolling */
  }
  .video-modal-content.dragging{ cursor:-webkit-grabbing; cursor:grabbing; }
  .video-modal-close{
    position:absolute;
    top:10px;
    right:10px;
    width:50px;
    height:50px;
    border-radius:50%;
    background:rgba(255,255,255,0.95);
    border:2px solid var(--black);
    cursor:pointer;
    display:flex;
    align-items:center;
    justify-content:center;
    transition:all .3s ease;
    box-shadow:0 4px 16px rgba(0,0,0,0.3);
    z-index:10003;
  }
  .video-modal-close:hover{
    background:var(--black);
    transform:rotate(90deg) scale(1.1);
  }
  .video-modal-close svg{
    width:24px;
    height:24px;
    stroke:var(--black);
    stroke-width:3;
    transition:stroke .3s ease;
  }
  .video-modal-close:hover svg{
    stroke:var(--white);
  }
  .video-modal video{
    display:block;
    width:auto;
    height:60vh;
    max-width:90vw;
    object-fit:cover;
    cursor:pointer;
    background:transparent !important;
    mix-blend-mode:screen;
    pointer-events:auto;
  }
  .video-modal canvas{
    display:none;
  }
  @media(max-width:768px){
    .video-modal-content{
      width:90vw;
      height:50vh;
    }
    .video-modal video{
      object-fit:contain;
      width:100%;
      height:100%;
    }
    .video-modal-close{
      top:5px;
      right:5px;
      width:44px;
      height:44px;
    }
    .video-modal-close svg{
      width:20px;
      height:20px;
    }
  }

  /* Speak to Sarah - Floating Button (Small Circle) */
  .sarah-float-btn{
    position:fixed;
    bottom:24px;
    right:24px;
    width:56px;
    height:56px;
    border-radius:50%;
    background:linear-gradient(135deg, var(--black) 0%, var(--g-700) 100%);
    border:2px solid var(--white);
    box-shadow:0 4px 16px rgba(11,11,11,.25), 0 8px 32px rgba(11,11,11,.15);
    cursor:pointer;
    z-index:999;
    display:flex;
    align-items:center;
    justify-content:center;
    transition:all .3s cubic-bezier(0.4, 0, 0.2, 1);
    overflow:visible;
  }
  .sarah-float-btn:hover{
    transform:scale(1.15) translateY(-2px);
    box-shadow:0 6px 24px rgba(11,11,11,.35), 0 12px 48px rgba(11,11,11,.25);
  }
  .sarah-float-btn svg{
    width:24px;
    height:24px;
    stroke:var(--white);
    stroke-width:2.5;
    fill:none;
    transition:transform .2s ease;
  }
  .sarah-float-btn:hover svg{
    transform:scale(1.1);
  }
  .sarah-float-btn::before{
    content:"";
    position:absolute;
    inset:-6px;
    border-radius:50%;
    background:conic-gradient(from 0deg, rgba(11,11,11,.25), transparent, rgba(11,11,11,.25));
    animation:rotatePulse 4s linear infinite;
    opacity:0;
    transition:opacity .3s ease;
  }
  .sarah-float-btn:hover::before{
    opacity:1;
  }
  @keyframes rotatePulse{
    to{ transform:rotate(360deg); }
  }


  /* Voice Chat Modal - Premium */
  .voice-modal{
    display:none;
    position:fixed;
    bottom:100px;
    right:90px;
    background:transparent;
    z-index:10000;
    width:400px;
    height:400px;
    animation:modalFadeIn .6s cubic-bezier(0.4, 0, 0.2, 1);
    pointer-events:auto;
    transform: scale(0.5);
    transform-origin: bottom right;
  }
  .voice-modal.active{
    display:flex;
  }
  @keyframes modalFadeIn{
    from{ opacity:0; }
    to{ opacity:1; }
  }
  /* Modal direct div - 400x400 size (scaled down to 50x50) */
  .voice-modal > div{
    position:relative;
    width:400px !important;
    height:400px !important;
    max-width:400px !important;
    max-height:400px !important;
    padding:0 !important;
    background:transparent;
    pointer-events:auto;
  }
  @keyframes modalSlideUp{
    from{ opacity:0; transform:translateY(40px) scale(.95); }
    to{ opacity:1; transform:translateY(0) scale(1); }
  }
  .voice-modal-close{
    position:absolute;
    top:-70px;
    right:-20px;
    width:60px;
    height:60px;
    border-radius:50%;
    background:var(--white);
    border:2px solid var(--black);
    cursor:pointer;
    display:flex;
    align-items:center;
    justify-content:center;
    transition:all .3s ease;
    box-shadow:0 4px 12px rgba(0,0,0,0.2);
    pointer-events:auto;
  }
  .voice-modal-close:hover{
    background:var(--black);
    transform:rotate(90deg);
  }
  .voice-modal-close svg{
    width:30px;
    height:30px;
    stroke:var(--black);
    stroke-width:3;
    transition:stroke .3s ease;
  }
  .voice-modal-close:hover svg{
    stroke:var(--white);
  }
  .voice-modal h2{
    margin-top:0;
    margin-bottom:12px;
    color:var(--black);
    font-size:clamp(26px,3.5vw,32px);
    text-align:center;
  }
  .voice-modal p{
    text-align:center;
    color:var(--g-600);
    margin-bottom:32px;
    font-size:16px;
  }
  .voice-avatar{
    width:140px;
    height:140px;
    margin:0 auto 28px;
    border-radius:50%;
    background:linear-gradient(135deg, var(--black) 0%, var(--g-700) 100%);
    display:flex;
    align-items:center;
    justify-content:center;
    position:relative;
    box-shadow:0 12px 48px rgba(11,11,11,.2), 0 0 0 8px rgba(11,11,11,.05);
  }
  .voice-avatar svg{
    width:72px;
    height:72px;
    stroke:var(--white);
    stroke-width:2;
    fill:none;
  }
  .voice-avatar::before{
    content:"";
    position:absolute;
    inset:-16px;
    border-radius:50%;
    border:3px solid rgba(11,11,11,.15);
    animation:voicePulse 2s ease-in-out infinite;
  }
  @keyframes voicePulse{
    0%, 100%{ transform:scale(1); opacity:.4; }
    50%{ transform:scale(1.15); opacity:.1; }
  }
  .voice-status{
    text-align:center;
    font-size:15px;
    color:var(--g-500);
    margin-bottom:24px;
    font-weight:500;
    min-height:24px;
  }
  .voice-controls{
    display:flex;
    gap:16px;
    justify-content:center;
    align-items:center;
  }
  .voice-btn{
    width:56px;
    height:56px;
    border-radius:50%;
    border:2px solid var(--g-800);
    background:linear-gradient(135deg, #fff 0%, #fafafa 100%);
    cursor:pointer;
    display:flex;
    align-items:center;
    justify-content:center;
    transition:all .3s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow:0 4px 16px rgba(0,0,0,.08);
  }
  .voice-btn svg{
    width:24px;
    height:24px;
    stroke:var(--g-800);
    stroke-width:2.5;
    fill:none;
  }
  .voice-btn:hover{
    background:var(--black);
    border-color:var(--black);
    transform:translateY(-3px);
    box-shadow:0 8px 24px rgba(11,11,11,.2);
  }
  .voice-btn:hover svg{
    stroke:var(--white);
  }
  .voice-btn.active{
    background:linear-gradient(135deg, var(--black) 0%, var(--g-700) 100%);
    border-color:var(--black);
  }
  .voice-btn.active svg{
    stroke:var(--white);
  }

  /* Debug Error Panel */
  .debug-panel{
    position:fixed;
    bottom:120px;
    right:32px;
    max-width:400px;
    max-height:300px;
    background:rgba(255,0,0,.95);
    border-radius:12px;
    padding:16px;
    box-shadow:0 8px 32px rgba(0,0,0,.4);
    z-index:9999;
    display:none;
    overflow-y:auto;
  }
  .debug-panel.show{
    display:block;
  }
  .debug-panel h3{
    margin:0 0 12px;
    color:#fff;
    font-size:14px;
    font-weight:600;
  }
  .debug-panel pre{
    margin:0;
    font-size:11px;
    color:#fff;
    white-space:pre-wrap;
    word-wrap:break-word;
    font-family:monospace;
    line-height:1.4;
  }

  @media(max-width:600px){
    .voice-modal{
      bottom:90px;
      right:24px;
      /* Fix for mobile Safari */
      -webkit-transform: scale(0.5);
      -webkit-transform-origin: bottom right;
    }
    .voice-modal > div{
      padding:0px !important;
      max-width:400px !important;
      width:400px !important;
      max-height:400px !important;
      height:400px !important;
    }
    .voice-modal rapport-scene{
      width:400px !important;
      height:400px !important;
    }
    .voice-modal-close{
      top:-60px !important;
      right:-15px !important;
      width:50px !important;
      height:50px !important;
      touch-action:manipulation;
      -webkit-tap-highlight-color:transparent;
    }
    .voice-modal-close svg{
      width:24px !important;
      height:24px !important;
    }
    .sarah-float-btn{
      width:64px;
      height:64px;
      bottom:24px;
      right:24px;
      -webkit-tap-highlight-color:transparent;
    }
    .sarah-float-btn svg{
      width:30px;
      height:30px;
    }
  }

  /* Loading bar animation */
  @keyframes loadingBar{
    0%{ transform:translateX(-100%); }
    50%{ transform:translateX(150%); }
    100%{ transform:translateX(-100%); }
  }

  /* Hide loading overlay */
  .voice-loading-hidden{
    opacity:0 !important;
    visibility:hidden !important;
    pointer-events:none !important;
  }

  /* Rapport scene container */
  rapport-scene {
    position: relative !important;
    display: block !important;
    width: 400px !important;
    height: 400px !important;
    opacity: 1 !important;
    visibility: visible !important;
    overflow: visible !important;
    /* WebKit specific fixes for Safari */
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
  }

  /* Hide Rapport badge and branding */
  rapport-scene::part(badge) {
    display: none !important;
    opacity: 0 !important;
    visibility: hidden !important;
    pointer-events: none !important;
  }

  /* Hide any powered-by or branding elements */
  rapport-scene [class*="powered"],
  rapport-scene [class*="branding"],
  rapport-scene [class*="badge"],
  rapport-scene [id*="powered"],
  rapport-scene [id*="branding"],
  rapport-scene [id*="badge"] {
    display: none !important;
    opacity: 0 !important;
    visibility: hidden !important;
    height: 0 !important;
    width: 0 !important;
    overflow: hidden !important;
  }
</style>

<!-- Premium inline SVG icon sprite (monochrome) -->
<svg xmlns="http://www.w3.org/2000/svg" style="display:none">
  <symbol id="i-voice" viewBox="0 0 24 24"><path d="M7 10a5 5 0 0 0 10 0V6a5 5 0 0 0-10 0v4z"/><path d="M5 10v0a7 7 0 0 0 14 0v0"/><path d="M12 21v-3M8 21h8" /></symbol>
  <symbol id="i-hw" viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="8" rx="2"/><rect x="3" y="12" width="18" height="8" rx="2"/><path d="M7 8h.01M7 16h.01"/></symbol>
  <symbol id="i-sec" viewBox="0 0 24 24"><path d="M12 3l7 4v5c0 5-3.5 8-7 9-3.5-1-7-4-7-9V7l7-4z"/><path d="M9.5 12l1.7 1.7 3.4-3.4"/></symbol>
  <symbol id="i-consult" viewBox="0 0 24 24"><path d="M3 20l3-3h10a5 5 0 0 0 0-10H9"/><path d="M7 7l2-2-2-2"/></symbol>
  <symbol id="i-legacy" viewBox="0 0 24 24"><circle cx="6" cy="12" r="2"/><circle cx="18" cy="6" r="2"/><circle cx="18" cy="18" r="2"/><path d="M8 12h8M16 8l2-2M16 16l2 2"/></symbol>
  <symbol id="i-omni" viewBox="0 0 24 24"><rect x="3" y="4" width="8" height="6" rx="1"/><rect x="13" y="4" width="8" height="6" rx="1"/><rect x="3" y="14" width="8" height="6" rx="1"/><rect x="13" y="14" width="8" height="6" rx="1"/></symbol>
  <symbol id="i-assist" viewBox="0 0 24 24"><path d="M12 12a5 5 0 1 0-5-5"/><path d="M3 21a7 7 0 0 1 14 0"/><circle cx="17.5" cy="6.5" r="2.5"/></symbol>
  <symbol id="i-shield" viewBox="0 0 24 24"><path d="M12 3l7 4v5c0 5-3.5 8-7 9-3.5-1-7-4-7-9V7l7-4z"/></symbol>
  <symbol id="i-mic" viewBox="0 0 24 24"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></symbol>
  <symbol id="i-phone" viewBox="0 0 24 24"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></symbol>
  <symbol id="i-close" viewBox="0 0 24 24"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></symbol>
  <symbol id="i-mute" viewBox="0 0 24 24"><path d="M11 5L6 9H2v6h4l5 4V5z"/><line x1="23" y1="9" x2="17" y2="15"/><line x1="17" y1="9" x2="23" y2="15"/></symbol>
  <symbol id="i-volume" viewBox="0 0 24 24"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"/></symbol>

  <!-- Chroma Key Filter for White Background Removal -->
  <filter id="chromakey" color-interpolation-filters="sRGB">
    <!-- Brighten the video first -->
    <feComponentTransfer result="brightened">
      <feFuncR type="linear" slope="1.3" intercept="0.05"/>
      <feFuncG type="linear" slope="1.3" intercept="0.05"/>
      <feFuncB type="linear" slope="1.3" intercept="0.05"/>
    </feComponentTransfer>

    <!-- Convert to grayscale to detect luminance -->
    <feColorMatrix type="matrix" values="0.2126 0.7152 0.0722 0 0
                                         0.2126 0.7152 0.0722 0 0
                                         0.2126 0.7152 0.0722 0 0
                                         0      0      0      1 0" in="brightened" result="gray"/>

    <!-- Create alpha mask: only very bright areas (white) become transparent -->
    <feColorMatrix type="matrix" values="1 0 0 0 0
                                         0 1 0 0 0
                                         0 0 1 0 0
                                         -0.8 -0.8 -0.8 1.8 -0.7" in="gray" result="alpha"/>

    <!-- Apply the alpha mask -->
    <feComposite in="brightened" in2="alpha" operator="in" result="masked"/>

    <!-- Enhance contrast and saturation -->
    <feColorMatrix type="matrix" values="1.15 0    0    0 0.02
                                         0    1.15 0    0 0.02
                                         0    0    1.15 0 0.02
                                         0    0    0    1 0" in="masked"/>
  </filter>
</svg>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=AW-17625349992"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);} 
  gtag('js', new Date());

  gtag('config', 'AW-17625349992');
</script>

<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Import Map for React -->
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^18.2.0",
    "react-dom/client": "https://esm.sh/react-dom@^18.2.0/client"
  }
}
</script>

<!-- Babel Standalone -->
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

</head>

<body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NR7C688Z"
height="0" width="0" style="display:none;visibility:hidden" title="Google Tag Manager"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<!-- Particle Background Layer -->
<iframe id="particle-bg" src="whiteparticle.html" title="Particle Background Animation"></iframe>

<!-- Sticky Glass Nav -->
<div class="top">
  <canvas id="mesh-canvas" aria-label="3D Mesh Background Animation"></canvas>
  <div class="wrap nav">
    <a href="index.html" class="brand"><img src="https://i.postimg.cc/CKDGzk0c/VCBWhite.jpg" alt="VCB - Viable Core Business"></a>
        <nav>
      <a href="index.html">Home</a>
      <a href="aboutus.html">About</a>
      <div class="dropdown">
        <a>Our AI Projects</a>
        <div class="dropdown-content">
          <a href="Lianela-info.html">LIANELA V3</a>
          <a href="SalesAgent.html">Voice-Agents</a>
          <a href="LLM-Ent.html">SIGMA</a>
          <a href="Compliance.html">Compliance</a>
          <a href="agenticai.html">AgenticAI</a>
          <a href="Model-Train.html">#ProjectDarkMatter</a>
        </div>
      </div>
      <a href="Partnerships.html">Partnerships</a>
      <button type="button" class="meet-vcb-seal" id="meetVCBBtn" aria-label="Watch VCB Introduction Video">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
        </svg>
        <span>Meet VCB</span>
      </button>
    </nav>
  </div>
</div>

<!-- Compliance Banner -->
<div class="compliance-banner">
  <div class="wrap">
    <p id="rotating-mission">Turn data into decisions through secure, privacy-by-design AI and auditable, high-performance storage.</p>
</div>
</div>

<!-- Countdown Clock -->
<div id="clock-root" style="position:relative; z-index:100; text-align:center; margin: 60px 0 40px 0; background: transparent;"></div>

<style>
  .preserve-3d {
    transform-style: preserve-3d;
  }
  .perspective {
    perspective: 1000px;
  }
  .backface-hidden {
    backface-visibility: hidden;
  }
  
  @keyframes pulse-glow {
    0%, 100% { box-shadow: 0 0 20px rgba(212,175,55,0.3), 0 0 40px rgba(212,175,55,0.2), 0 10px 30px rgba(0,0,0,0.1); }
    50% { box-shadow: 0 0 30px rgba(212,175,55,0.5), 0 0 60px rgba(212,175,55,0.3), 0 15px 40px rgba(0,0,0,0.15); }
  }
  
  @keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-5px); }
  }
  
  .countdown-container {
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    animation: float 3s ease-in-out infinite;
  }
  
  .countdown-container:hover {
    transform: translateY(-8px) scale(1.02);
  }
  
  .countdown-wrapper {
    display: inline-block;
    background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(250,250,250,0.9) 100%);
    border: 2px solid rgba(212,175,55,0.3);
    border-radius: 24px;
    padding: 32px 48px;
    backdrop-filter: blur(12px);
    animation: pulse-glow 2s ease-in-out infinite;
    box-shadow: 0 0 20px rgba(212,175,55,0.3), 0 10px 30px rgba(0,0,0,0.1);
  }
  
  .countdown-title {
    font-size: clamp(18px, 3vw, 24px);
    font-weight: 700;
    background: linear-gradient(135deg, #D4AF37 0%, #B8942D 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 16px;
    letter-spacing: 0.5px;
    text-transform: uppercase;
  }
  
  .countdown-subtitle {
    font-size: clamp(12px, 2vw, 14px);
    color: #666;
    margin-top: 12px;
    font-weight: 500;
  }
</style>

<script type="text/babel" data-type="module">
  import React, { useState, useEffect, useRef } from 'react';
  import ReactDOM from 'react-dom/client';

  // Sound generation
  const playFlipSound = (audioContext, delay = 0) => {
    if (!audioContext) return;
    if (audioContext.state === 'suspended') {
      audioContext.resume();
    }

    const startTime = audioContext.currentTime + delay;
    const attackTime = 0.003;
    const decayTime = 0.1;
    const whirrDuration = 0.05;
    const mainImpactOffset = 0.02;

    const compressor = audioContext.createDynamicsCompressor();
    compressor.threshold.setValueAtTime(-30, startTime);
    compressor.knee.setValueAtTime(30, startTime);
    compressor.ratio.setValueAtTime(12, startTime);
    compressor.attack.setValueAtTime(0.003, startTime);
    compressor.release.setValueAtTime(0.15, startTime);
    compressor.connect(audioContext.destination);

    const whirrOsc = audioContext.createOscillator();
    const whirrGain = audioContext.createGain();
    whirrOsc.type = 'sawtooth';
    whirrOsc.frequency.setValueAtTime(80, startTime);
    whirrOsc.frequency.linearRampToValueAtTime(120, startTime + whirrDuration);
    
    whirrGain.gain.setValueAtTime(0, startTime);
    whirrGain.gain.linearRampToValueAtTime(0.1, startTime + attackTime);
    whirrGain.gain.exponentialRampToValueAtTime(0.0001, startTime + whirrDuration);

    whirrOsc.connect(whirrGain);
    whirrGain.connect(compressor);

    const bufferSize = audioContext.sampleRate * 0.1;
    const noiseBuffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
    const output = noiseBuffer.getChannelData(0);
    for (let i = 0; i < bufferSize; i++) {
      output[i] = Math.random() * 2 - 1;
    }

    const noiseSource = audioContext.createBufferSource();
    noiseSource.buffer = noiseBuffer;

    const noiseFilter = audioContext.createBiquadFilter();
    noiseFilter.type = 'bandpass';
    noiseFilter.frequency.setValueAtTime(900, startTime);
    noiseFilter.Q.setValueAtTime(5, startTime);

    const noiseGain = audioContext.createGain();
    noiseGain.gain.setValueAtTime(0, startTime + mainImpactOffset);
    noiseGain.gain.linearRampToValueAtTime(1.0, startTime + mainImpactOffset + attackTime);
    noiseGain.gain.exponentialRampToValueAtTime(0.0001, startTime + mainImpactOffset + decayTime);

    noiseSource.connect(noiseFilter);
    noiseFilter.connect(noiseGain);
    noiseGain.connect(compressor);

    const bodyOsc = audioContext.createOscillator();
    const bodyFilter = audioContext.createBiquadFilter();
    const bodyGain = audioContext.createGain();
    
    bodyOsc.type = 'triangle';
    bodyOsc.frequency.setValueAtTime(120, startTime);

    bodyFilter.type = 'lowpass';
    bodyFilter.frequency.setValueAtTime(300, startTime);

    bodyGain.gain.setValueAtTime(0, startTime + mainImpactOffset);
    bodyGain.gain.linearRampToValueAtTime(0.7, startTime + mainImpactOffset + attackTime);
    bodyGain.gain.exponentialRampToValueAtTime(0.0001, startTime + mainImpactOffset + decayTime);
    
    bodyOsc.connect(bodyFilter);
    bodyFilter.connect(bodyGain);
    bodyGain.connect(compressor);

    whirrOsc.start(startTime);
    whirrOsc.stop(startTime + whirrDuration);
    
    noiseSource.start(startTime + mainImpactOffset);
    noiseSource.stop(startTime + mainImpactOffset + decayTime);
    
    bodyOsc.start(startTime + mainImpactOffset);
    bodyOsc.stop(startTime + mainImpactOffset + decayTime);
  };

  // DigitCard component
  const DigitCard = ({ digit, position }) => {
    const isTop = position === 'top';
    const baseClasses = "w-full h-full flex items-center justify-center text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-mono font-bold text-gray-900 bg-gradient-to-b from-gray-200 via-white to-gray-300 shadow-inner [text-shadow:0_1px_1px_rgba(255,255,255,0.5)]";
    const positionClasses = isTop ? "rounded-t-lg items-end pb-1" : "rounded-b-lg items-start pt-1";
    const innerDivClasses = isTop ? "border-b border-black/20" : "";
    return (
      <div className={`${baseClasses} ${positionClasses}`}>
        <div className={`${innerDivClasses} w-full h-full flex items-center justify-center`}>
          {digit}
        </div>
      </div>
    );
  };

  // FlipUnit component
  const FlipUnit = ({ digit, isMuted, audioContext }) => {
    const [currentDigit, setCurrentDigit] = useState(digit);
    const [previousDigit, setPreviousDigit] = useState(digit);
    const [isFlipping, setIsFlipping] = useState(false);
    useEffect(() => {
      if (digit !== currentDigit) {
        if (!isMuted && audioContext) {
          playFlipSound(audioContext, 0.38);
        }
        setPreviousDigit(currentDigit);
        setCurrentDigit(digit);
        setIsFlipping(true);
      }
    }, [digit, currentDigit, isMuted, audioContext]);
    useEffect(() => {
      if (!isFlipping) return;
      const timeoutId = setTimeout(() => {
        setPreviousDigit(digit);
        setIsFlipping(false);
      }, 500);
      return () => clearTimeout(timeoutId);
    }, [isFlipping, digit]);
    return (
      <div className="relative w-10 h-16 sm:w-12 sm:h-20 md:w-16 md:h-24 lg:w-20 lg:h-32 perspective shadow-lg shadow-black/40 rounded-lg overflow-hidden">
        <div className="absolute top-0 left-0 w-full h-full bg-[linear-gradient(165deg,rgba(255,255,255,0.2)_0%,rgba(255,255,255,0)_20%)] z-30 pointer-events-none"></div>
        <div className="absolute top-1/2 left-0 w-full h-1/2">
          <DigitCard digit={previousDigit} position="bottom" />
        </div>
        <div className="absolute top-0 left-0 w-full h-1/2">
          <DigitCard digit={currentDigit} position="top" />
        </div>
        <div className="absolute top-1/2 -mt-px w-full h-px bg-black/50 z-20"></div>
        <div className={`absolute top-0 left-0 w-full h-1/2 origin-bottom transition-transform duration-500 ease-[cubic-bezier(0.45,0,0.55,1)] preserve-3d ${isFlipping ? '[transform:rotateX(-180deg)]' : ''}`}>
          <div className="absolute inset-0 backface-hidden z-10">
            <DigitCard digit={previousDigit} position="top" />
          </div>
          <div className="absolute inset-0 [transform:rotateX(180deg)] backface-hidden">
            <DigitCard digit={currentDigit} position="bottom" />
          </div>
        </div>
      </div>
    );
  };

  // Separator component
  const Separator = () => (
    <div className="flex flex-col gap-1.5 md:gap-2">
      <div className="w-1.5 h-1.5 md:w-2 md:h-2 rounded-full bg-gradient-to-br from-yellow-600 to-yellow-700 ring-1 ring-inset ring-yellow-800/30 shadow-sm"></div>
      <div className="w-1.5 h-1.5 md:w-2 md:h-2 rounded-full bg-gradient-to-br from-yellow-600 to-yellow-700 ring-1 ring-inset ring-yellow-800/30 shadow-sm"></div>
    </div>
  );

  // TimeLabel component
  const TimeLabel = ({ label }) => (
    <div className="text-center text-gray-600 text-xs md:text-sm font-semibold uppercase tracking-wider mt-2">
      {label}
    </div>
  );

  // FlipClock component for countdown
  const FlipClock = ({ days, hours, minutes, seconds, isMuted, audioContext }) => {
    const daysStr = days.toString().padStart(2, '0');
    const hoursStr = hours.toString().padStart(2, '0');
    const minutesStr = minutes.toString().padStart(2, '0');
    const secondsStr = seconds.toString().padStart(2, '0');
    
    return (
      <div className="flex flex-col items-center justify-center">
        <div className="flex items-center justify-center gap-2 md:gap-4">
          <div className="flex flex-col items-center">
            <div className="flex gap-1">
              <FlipUnit digit={daysStr[0]} audioContext={audioContext} isMuted={isMuted} />
              <FlipUnit digit={daysStr[1]} audioContext={audioContext} isMuted={isMuted} />
            </div>
            <TimeLabel label="Days" />
          </div>
          <Separator />
          <div className="flex flex-col items-center">
            <div className="flex gap-1">
              <FlipUnit digit={hoursStr[0]} audioContext={audioContext} isMuted={isMuted} />
              <FlipUnit digit={hoursStr[1]} audioContext={audioContext} isMuted={isMuted} />
            </div>
            <TimeLabel label="Hours" />
          </div>
          <Separator />
          <div className="flex flex-col items-center">
            <div className="flex gap-1">
              <FlipUnit digit={minutesStr[0]} audioContext={audioContext} isMuted={isMuted} />
              <FlipUnit digit={minutesStr[1]} audioContext={audioContext} isMuted={isMuted} />
            </div>
            <TimeLabel label="Minutes" />
          </div>
          <Separator />
          <div className="flex flex-col items-center">
            <div className="flex gap-1">
              <FlipUnit digit={secondsStr[0]} audioContext={audioContext} isMuted={isMuted} />
              <FlipUnit digit={secondsStr[1]} audioContext={audioContext} isMuted={isMuted} />
            </div>
            <TimeLabel label="Seconds" />
          </div>
        </div>
      </div>
    );
  };



  // Main App component
  const CountdownApp = () => {
    const targetDate = new Date('2025-10-16T15:00:00+02:00');
    const [remaining, setRemaining] = useState(0);
    const [isMuted, setIsMuted] = useState(true);
    const audioContextRef = useRef(null);
    
    useEffect(() => {
      const interval = setInterval(() => {
        const now = new Date();
        const diff = targetDate - now;
        setRemaining(Math.max(0, diff));
      }, 1000);
      return () => clearInterval(interval);
    }, []);
    
    const days = Math.floor(remaining / (1000*60*60*24));
    const hours = Math.floor((remaining % (1000*60*60*24)) / (1000*60*60));
    const minutes = Math.floor((remaining % (1000*60*60)) / (1000*60));
    const seconds = Math.floor((remaining % (1000*60)) / 1000);
    
    const handleClick = () => {
      const eventSection = document.querySelector('.event-exclusive');
      if (eventSection) {
        eventSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    };

    return (
      <div className="countdown-container" onClick={handleClick}>
        <div className="countdown-wrapper">
          <h3 className="countdown-title">âš–ï¸ Exclusive Legal Webinar</h3>
          <FlipClock 
            days={days} 
            hours={hours} 
            minutes={minutes} 
            seconds={seconds} 
            isMuted={isMuted} 
            audioContext={audioContextRef.current} 
          />
          <p className="countdown-subtitle">
            October 16, 2025 Â· 15:00 SAST Â· Click to Register
          </p>
        </div>
      </div>
    );
  };

  // Render
  const clockRoot = document.getElementById('clock-root');
  if (clockRoot) {
    const root = ReactDOM.createRoot(clockRoot);
    root.render(
      <React.StrictMode>
        <CountdownApp />
      </React.StrictMode>
    );
  }
</script>

<!-- HERO -->
<header class="hero">
  <div class="wrap">
    <h1 class="reveal">Strategy that ships. Governance that holds.</h1>
    <p class="lede reveal">
      Voice-first agents that escalate to humans, Ultra-low-latency Storage & Strategic Software supply, and trusted consulting that keeps you compliant.
      One partner. Outcomes only.
    </p>
    <div class="badges reveal">
      <span class="badge">Model-agnostic</span>
      <span class="badge">POPIA-first</span>
      <span class="badge">Court-grade auditability</span>
      <span class="badge">Sovereign-capable</span>
      <span class="badge">Next-Gen</span>
    </div>
    <div class="stats reveal">
      <div class="stat"><div class="n">90.11%</div><div class="l">Peak legal accuracy</div></div>
      <div class="stat"><div class="n">1,000,000</div><div class="l">Token context window</div></div>
      <div class="stat"><div class="n">6</div><div class="l">Judicial skill domains</div></div>
      <div class="stat"><div class="n">100%</div><div class="l">Traceability coverage</div></div>
    </div>
    <!-- CTA to the separate page -->
    <div class="cta-row reveal">
      <a class="btn" href="Compliance.html">Explore Intelligent Compliance</a>
      <!-- add target="_blank" rel="noopener" to open in new tab -->
    </div>
  </div>
</header>

<!-- Exclusive Event Banner -->
<div class="event-exclusive">
  <div class="wrap">
    <div class="exclusive-tag">Open to All Â· R200 per person</div>
    <h2>Will the New LRA Protect You or Expose You?</h2>
    <p>
      The first biggest change in 30 years to dismissals. High Court Advocates debate the new Schedule 8 of the LRA.
       Every employee and employer must know the impact. 
      16 October 2025 Â· Microsoft Teams
    </p>
    <a href="event.html" class="btn-gold">Register Now â€” R200</a>
    <div class="event-meta">15:00 SAST Â· Microsoft Teams Virtual Event</div>
    <p style="margin-top:20px; font-size:13px; color:#9A9A9A; letter-spacing:1px; text-transform:uppercase;">
      Sponsored by <span style="color:#D4AF37; font-weight:600;">LIANELA</span>
    </p>
  </div>
</div>

<main class="wrap">

  <!-- TRACKS -->
  <section id="tracks" class="section">
    <h2 class="reveal">Six Tracks. One Backbone.</h2>
    <hr class="divider" />
    <div class="grid-3">
      <article class="card tile reveal">
        <div class="head"><svg class="icon"><use href="#i-voice"/></svg><h3>Voice Agents</h3></div>
        <p>Production phone agents with omnichannel continuation and live human assist.</p>
        <ul>
          <li>Inbound/Outbound, natural turn-taking</li>
          <li>WhatsApp, FB Messenger, SMS, Email, Web chat</li>
          <li>Whisper Â· Barge-in Â· Warm transfer Â· 3-way</li>
        </ul>
      </article>

      <article class="card tile reveal">
        <div class="head"><svg class="icon"><use href="#i-hw"/></svg><h3>Hardware & Software</h3></div>
        <p>Enterprise-Grade Sourcing
From brief to hand-over. We source, integrate, image, asset-tag, and support for traditional IT estates.</p>
        <ul>
          <li>Compute/Storage (SAN/NAS) Â· Backup/DR</li>
          <li>Networking/Edge Â· VoIP/SIP gateways</li>
          <li>Licensing Â· MDM/UEM Â· Security stack</li>
        </ul>
      </article>

      <article class="card tile reveal">
        <div class="head"><svg class="icon"><use href="#i-consult"/></svg><h3>Trusted Advisor</h3></div>
        <p>Architecture, delivery, and operations â€” AI when smart, non-AI when smarter.</p>
        <ul>
          <li>RFP/RFQ support, cost & contract optimisation</li>
          <li>Deploy Â· Migrate Â· Integrate</li>
          <li>Operate with observability & runbooks</li>
        </ul>
      </article>

      <!-- OPTIONAL: Dedicated tile linking to the separate compliance page -->
      <article class="card tile reveal">
        <div class="head"><svg class="icon"><use href="#i-shield"/></svg><h3>Intelligent Compliance</h3></div>
        <p>Proactive dispute prediction, SA-aware docs, and B-BBEE planning â€” with voice + omnichannel access.</p>
        <p><a class="btn" href="Compliance.html">View the page</a></p>
      </article>

      <article class="card tile reveal">
        <div class="head"><svg class="icon"><use href="#i-consult"/></svg><h3>Consulting</h3></div>
        <p>Independent, expert guidance from idea to outcome.</p>
        <ul>
          <li>Independent, expert guidance from idea to outcome. Discovery & strategy Â· TCO/ROI</li>
          <li>Governance & compliance: POPIA/GDPR Â· risk & policy frameworks Â· B-BBEE alignment</li>
          <li>Delivery enablement (Sovereign AI consulting & localised LLM support Â· change management Â· executive advisory).</li>
        </ul>
      </article>

      <article class="card tile reveal">
        <div class="head"><svg class="icon"><use href="#i-voice"/></svg><h3>Gen AI</h3></div>
        <p>Secure, SA-ready generative AIâ€”from prototype to production.</p>
        <ul>
          <li>RAG & fine-tuning Â· evals & guardrails Â· PII redaction & safety by design</li>
          <li>MLOps & orchestration: pipelines Â· vector DBs Â· observability & cost controls</li>
          <li>Multilingual/domain packs: English/Afrikaans/isiZulu etc. Â· legal, insurance, finance</li>
        </ul>
      </article>
    </div>
  </section>

  <!-- CAPABILITIES -->
  <section id="capabilities" class="section">
    <h2 class="reveal">Capabilities We Bring</h2>
    <hr class="divider" />
    <div class="grid-2">
      <div class="card reveal">
        <div class="lane">
          <div class="lanetag"><svg class="icon"><use href="#i-omni"/></svg></div>
          <div>
            <strong>Omnichannel Continuity</strong>
            <p>Single memory across voice and messaging. Consent, transcripts, and audit preserved end-to-end.</p>
          </div>
        </div>
        <div class="lane">
          <div class="lanetag"><svg class="icon"><use href="#i-assist"/></svg></div>
          <div>
            <strong>Call-in Human Assistance</strong>
            <p>Whisper coaching, instant takeover, warm transfers, and conference for complex cases.</p>
          </div>
        </div>
        <div class="lane">
          <div class="lanetag"><svg class="icon"><use href="#i-sec"/></svg></div>
          <div>
            <strong>Security & Governance</strong>
            <p>POPIA-aligned by design: redaction, RBAC, retention, and full traceability for critical decisions.</p>
          </div>
        </div>
      </div>

      <div class="card reveal">
        <div class="lane">
          <div class="lanetag"><svg class="icon"><use href="#i-legacy"/></svg></div>
          <div>
            <strong>Legacy AI & Data</strong>
            <p>Classical ML, ETL/ELT, lakehouse patterns, search/RAG, and evaluation harnesses that donâ€™t break.</p>
          </div>
        </div>
        <div class="lane">
          <div class="lanetag"><svg class="icon"><use href="#i-hw"/></svg></div>
          <div>
            <strong>Enterprise Grade Sourcing</strong>
            <p>Spec-based or outcome-based supply. We source, integrate, image, tag, and support.</p>
          </div>
        </div>
        <div class="lane">
          <div class="lanetag"><svg class="icon"><use href="#i-consult"/></svg></div>
          <div>
            <strong>Operate</strong>
            <p>Managed patching, SIEM/EDR integrations, incident runbooks, and sovereignty options.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- PROOF -->
  <section id="proof" class="section">
    <h2 class="reveal">Proof, Not Promises</h2>
    <hr class="divider" />
    <div class="grid-4">
      <article class="card tile reveal">
        <div class="head"><svg class="icon"><use href="#i-voice"/></svg><h3>Legal-grade Outputs</h3></div>
        <p>Structured reasoning, <em>ratio decidendi</em> capture, and complete evidentiary trails.</p>
      </article>
      <article class="card tile reveal">
        <div class="head"><svg class="icon"><use href="#i-legacy"/></svg><h3>Ultra-Long Context</h3></div>
        <p>Up to 1M tokens â€” grounded answers without brittle chunking.</p>
      </article>
      <article class="card tile reveal">
        <div class="head"><svg class="icon"><use href="#i-sec"/></svg><h3>Traceability</h3></div>
        <p>100% decision traceability and audit logs attached to each case.</p>
      </article>
      <article class="card tile reveal">
        <div class="head"><svg class="icon"><use href="#i-hw"/></svg><h3>Run in the Real World</h3></div>
        <p>From racks to routers to headsets â€” we ship the plumbing so the outcomes stick.</p>
      </article>
    </div>
  </section>

  <!-- VISION & MISSION -->
  <section id="vision" class="section">
    <h2 class="reveal">Our Vision & Mission</h2>
    <hr class="divider" />

    <div class="grid-2">
      <div class="card reveal">
        <h3>Vision</h3>
        <p>To be the essential, integrated partner for businesses in South Africa, driving the future of data-driven innovation by delivering cohesive AI software and core storage and datacentre hardware solutions.</p>
      </div>

      <div class="card reveal">
        <h3>Mission</h3>
        <p>To turn AI into measurable outcomes without compromising trust: encryption everywhere, zero-trust access, model governance, data sovereignty options, and immutable, enterprise-grade storage to keep systems fast, reliable, and compliant.</p>
      </div>
    </div>

    <div class="card reveal" style="margin-top:20px; text-align:center; background:linear-gradient(180deg,#fff,#FAFAFA);">
      <h3>You're in Capable Hands</h3>
      <p style="max-width:800px; margin:0 auto;">With decades of combined expertise in AI, legal compliance, and infrastructure, VCB is your trusted partner for transforming vision into viable outcomes. We deliver solutions that workâ€”backed by experience, precision, and unwavering commitment to your success.</p>
      <div class="cta-row reveal" style="margin-top:18px; justify-content:center;">
        <a class="btn" href="aboutus.html">Meet Our Team</a>
      </div>
    </div>
  </section>

</main>

<!-- Video Modal - Meet VCB -->
<div class="video-modal" id="videoModal">
  <div class="video-modal-content">
    <button type="button" class="video-modal-close" id="closeVideoModal" aria-label="Close video">
      <svg><use href="#i-close"/></svg>
    </button>
    <video id="vcbVideo" autoplay muted playsinline webkit-playsinline x-webkit-airplay="allow" style="background:transparent;mix-blend-mode:normal">
      <source id="vcbVideoSource" src="vee01_alpha.webm" type="video/webm">
      <source src="vee01.mp4" type="video/mp4">
      Your browser does not support video playback.
    </video>
    <div style="position:absolute; bottom:20px; left:50%; transform:translateX(-50%); background:rgba(255,255,255,0.9); padding:10px 20px; border-radius:8px; font-size:14px; display:none;" id="playHint">
      Click video to play
    </div>
  </div>
</div>

<footer>
  Â© <span id="year"></span> VCB Â· Viable Core Business â€” Vision becomes Viable. Â· <a href="privacy.html">Privacy</a>
</footer>

<!-- Speak to Sarah - Floating Button -->
<div class="sarah-float-btn" id="sarahFloatBtn" role="button" aria-label="Speak to Sarah voice assistant" tabindex="0">
  <svg><use href="#i-mic"/></svg>
</div>

<!-- Voice Chat Modal -->
<div class="voice-modal" id="voiceModal">
  <div style="position:relative; pointer-events:auto;">
    <button type="button" class="voice-modal-close" id="closeModal" aria-label="Close voice chat">
      <svg><use href="#i-close"/></svg>
    </button>

    <rapport-scene
      project-token="eec9c8d2-eb1c-47c2-bdda-ab8bbbb7ffbe"
      style="width: 400px; height: 400px; background: transparent; pointer-events:auto; display:block; position:relative; z-index:10;"
    ></rapport-scene>

    <!-- Powered by VCB Badge -->
    <div style="position:absolute; top:-10px; right:200px; display:flex; align-items:center; gap:6px; font-size:22px; color:#0B0B0B; background:rgba(255,255,255,0.95); padding:8px 16px; border-radius:16px; z-index:10003; pointer-events:none; font-family:'Quicksand',sans-serif; font-weight:700; white-space:nowrap;">
      <span style="width:12px; height:12px; background:#0B0B0B; border-radius:50%; display:inline-block;"></span>
      Powered by VCB
    </div>

    <!-- Premium Loading Overlay -->
    <div id="voiceLoadingOverlay" style="position:absolute; inset:0; background:transparent; display:flex; flex-direction:column; align-items:center; justify-content:center; z-index:10002; transition:opacity 0.4s ease, visibility 0.4s ease; border-radius:8px; pointer-events:auto;">
      <div class="spinner-container" style="position:relative; width:200px; height:200px;">
        <!-- Outer counter-clockwise ring -->
        <div class="spinner-ring spinner-ring-outer" style="position:absolute; inset:-20px; border:8px solid transparent; border-top-color:rgba(11,11,11,0.3); border-left-color:rgba(11,11,11,0.3); border-radius:50%; animation:spinCounterClockwise 2s linear infinite;"></div>
        <!-- Static background ring -->
        <div style="position:absolute; inset:0; border:6px solid rgba(11,11,11,0.1); border-radius:50%;"></div>
        <!-- Inner clockwise spinning ring -->
        <div class="spinner-ring spinner-ring-inner" style="position:absolute; inset:0; border:6px solid transparent; border-top-color:var(--black); border-right-color:var(--black); border-radius:50%; animation:spinRing 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;"></div>
        <!-- Inner pulsing circle -->
        <div class="spinner-core" style="position:absolute; inset:40px; background:linear-gradient(135deg, var(--black) 0%, var(--g-700) 100%); border-radius:50%; animation:pulse 1.5s ease-in-out infinite;"></div>
        <!-- Microphone icon -->
        <svg class="spinner-icon" style="position:absolute; inset:0; margin:auto; width:64px; height:64px; stroke:white; stroke-width:2; fill:none; animation:fadeIn 0.6s ease-in-out;">
          <use href="#i-mic"/>
        </svg>
      </div>
      <p style="margin-top:20px; color:var(--g-700); font-size:14px; font-weight:500; letter-spacing:0.3px; animation:fadeIn 0.8s ease-in-out;">Connecting voice...</p>
    </div>

    <style>
      @keyframes spinRing{
        0%{ transform:rotate(0deg); }
        100%{ transform:rotate(360deg); }
      }
      @keyframes spinCounterClockwise{
        0%{ transform:rotate(360deg); }
        100%{ transform:rotate(0deg); }
      }
      @keyframes pulse{
        0%, 100%{ transform:scale(1); opacity:1; }
        50%{ transform:scale(0.85); opacity:0.8; }
      }
      #voiceLoadingOverlay.spinner-paused .spinner-ring,
      #voiceLoadingOverlay.spinner-paused .spinner-core,
      #voiceLoadingOverlay.spinner-paused .spinner-icon{
        animation-play-state: paused !important;
      }
      @keyframes fadeIn{
        from{ opacity:0; }
        to{ opacity:1; }
      }
    </style>
  </div>
</div>

<!-- Debug Error Panel -->
<div class="debug-panel" id="debugPanel">
  <h3>ðŸ” Debug Console</h3>
  <pre id="debugLog"></pre>
</div>

<!-- GSAP (not needed anymore) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>

<script type="importmap">
  {
    "imports": {
      "react": "https://esm.sh/react@^18.2.0",
      "react-dom/client": "https://esm.sh/react-dom@^18.2.0/client"
    }
  }
  </script>
  <script>
  // Year
  document.getElementById('year').textContent = new Date().getFullYear();  // Sophisticated 3D Wire Mesh Animation
  (() => {
    const canvas = document.getElementById('mesh-canvas');
    if(!canvas) return;
    const ctx = canvas.getContext('2d', { alpha: true, desynchronized: true });

    // Enable smooth rendering
    ctx.imageSmoothingEnabled = true;
    ctx.imageSmoothingQuality = 'high';

    const gridSize = 15; // much denser mesh for HD quality
    let cols = 0;
    let rows = 0;
    let time = 0;

    function resize(){
      const dpr = 2; // device pixel ratio multiplier
      const rect = canvas.getBoundingClientRect();
      canvas.width = rect.width * dpr;
      canvas.height = rect.height * dpr;
      ctx.scale(dpr, dpr);
      cols = Math.ceil(rect.width / gridSize) + 2;
      rows = Math.ceil(rect.height / gridSize) + 2;
    }
    resize();
    window.addEventListener('resize', resize);

    // AI-like complex noise function
    function complexNoise(x, y, t){
      let n = 0;
      // Multiple octaves for Perlin-like noise
      n += Math.sin(x * 0.1 + t * 0.3) * Math.cos(y * 0.15 - t * 0.4) * 12;
      n += Math.sin(x * 0.23 + y * 0.17 + t * 0.6) * 8;
      n += Math.cos(x * 0.31 - y * 0.22 + t * 0.9) * 6;
      n += Math.sin((x + y) * 0.08 + t * 1.2) * 10;
      n += Math.cos((x - y) * 0.13 + t * 0.5) * 7;
      // Turbulence
      n += Math.sin(x * 0.5 + Math.cos(y * 0.4 + t)) * 4;
      return n;
    }

    // Calculate 3D position with AI-generated complexity
    function get3DPoint(col, row, t){
      const x = col * gridSize - gridSize;
      const y = row * gridSize - gridSize;

      // Complex AI-like displacement
      const displacement = complexNoise(col, row, t);

      // Spiral/vortex patterns
      const angle = Math.atan2(row - rows/2, col - cols/2);
      const radius = Math.hypot(col - cols/2, row - rows/2);
      const spiral = Math.sin(angle * 3 + radius * 0.2 - t * 2) * 5;

      // Neural-network-like pulsing
      const pulse = Math.sin(t * 3 + col * 0.3) * Math.cos(t * 2.5 + row * 0.25) * 8;

      // Calculate depth with multiple layers
      const depth1 = Math.sin(col * 0.2 + t) * Math.cos(row * 0.25 + t * 0.7) * 35;
      const depth2 = Math.sin(radius * 0.1 + t * 1.5) * 15;
      const depth = depth1 + depth2;

      return {
        x: x + displacement + spiral,
        y: y + displacement + pulse,
        z: depth,
        col: col,
        row: row,
        energy: Math.abs(Math.sin(col * 0.3 + row * 0.2 + t * 2)) // for energy flow
      };
    }

    function animate(){
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      time += 0.010;

      // Store all points with depth
      const points = [];
      for(let row = 0; row < rows; row++){
        points[row] = [];
        for(let col = 0; col < cols; col++){
          points[row][col] = get3DPoint(col, row, time);
        }
      }

      // Draw horizontal lines with depth-based styling - much thinner
      for(let row = 0; row < rows; row++){
        ctx.beginPath();
        for(let col = 0; col < cols; col++){
          const p = points[row][col];

          // Depth influences opacity and thickness - thinner lines
          const depthFactor = (p.z + 35) / 70; // normalize 0-1
          ctx.strokeStyle = `rgba(86, 86, 86, ${0.2 + depthFactor * 0.5})`;
          ctx.lineWidth = 0.3 + depthFactor * 0.4;

          if(col === 0) ctx.moveTo(p.x, p.y);
          else ctx.lineTo(p.x, p.y);
        }
        ctx.stroke();
      }

      // Draw vertical lines with depth-based styling - thinner
      const canvasHeight = canvas.height / 2; // adjust for DPR
      for(let col = 0; col < cols; col++){
        ctx.beginPath();
        for(let row = 0; row < rows; row++){
          const p = points[row][col];

          const depthFactor = (p.z + 35) / 70;
          ctx.strokeStyle = `rgba(86, 86, 86, ${0.2 + depthFactor * 0.5})`;
          ctx.lineWidth = 0.3 + depthFactor * 0.4;

          // Make bottom edge straight/flat
          const yPos = (row === rows - 1) ? canvasHeight - 1 : p.y;

          if(row === 0) ctx.moveTo(p.x, yPos);
          else ctx.lineTo(p.x, yPos);
        }
        ctx.stroke();
      }

      // Add subtle diagonal connections for enhanced 3D effect - thinner
      ctx.lineWidth = 0.2;
      for(let row = 0; row < rows - 1; row++){
        for(let col = 0; col < cols - 1; col++){
          const p1 = points[row][col];
          const p2 = points[row + 1][col + 1];

          // Only draw some diagonals based on depth and energy
          if(Math.abs(p1.z - p2.z) > 10 || (p1.energy > 0.7 && p2.energy > 0.7)){
            const avgDepth = (p1.z + p2.z) / 2;
            const avgEnergy = (p1.energy + p2.energy) / 2;
            const depthFactor = (avgDepth + 35) / 70;
            const opacity = 0.1 + depthFactor * 0.3 + avgEnergy * 0.2;
            ctx.strokeStyle = `rgba(86, 86, 86, ${opacity})`;
            ctx.beginPath();
            ctx.moveTo(p1.x, p1.y);
            ctx.lineTo(p2.x, p2.y);
            ctx.stroke();
          }
        }
      }

      // Draw energy flow lines (AI neural-network style) - thinner
      ctx.lineWidth = 0.25;
      for(let row = 1; row < rows - 1; row += 2){
        for(let col = 1; col < cols - 1; col += 2){
          const p = points[row][col];
          if(p.energy > 0.6){
            // Find nearby high-energy nodes and connect
            for(let dr = -2; dr <= 2; dr++){
              for(let dc = -2; dc <= 2; dc++){
                if(dr === 0 && dc === 0) continue;
                const nr = row + dr;
                const nc = col + dc;
                if(nr >= 0 && nr < rows && nc >= 0 && nc < cols){
                  const neighbor = points[nr][nc];
                  if(neighbor.energy > 0.6){
                    const distance = Math.hypot(dr, dc);
                    const energyFlow = (p.energy + neighbor.energy) / 2;
                    ctx.strokeStyle = `rgba(66, 66, 66, ${energyFlow * 0.15 / distance})`;
                    ctx.beginPath();
                    ctx.moveTo(p.x, p.y);
                    ctx.lineTo(neighbor.x, neighbor.y);
                    ctx.stroke();
                  }
                }
              }
            }
          }
        }
      }

      // Draw 3D connector dots at intersection points
      for(let row = 0; row < rows; row++){
        for(let col = 0; col < cols; col++){
          const p = points[row][col];
          const depthFactor = (p.z + 35) / 70;

          // Dot size varies with depth AND energy - smaller/thinner
          const energyBoost = p.energy > 0.7 ? p.energy * 0.5 : 0;
          const dotSize = 1 + depthFactor * 1.5 + energyBoost;

          // 3D gradient effect - darker grey with energy glow
          const gradient = ctx.createRadialGradient(
            p.x - dotSize * 0.3, p.y - dotSize * 0.3, 0,
            p.x, p.y, dotSize
          );
          const energyGlow = p.energy > 0.7 ? 0.15 : 0;
          gradient.addColorStop(0, `rgba(42, 42, 42, ${0.7 + depthFactor * 0.3 + energyGlow})`);
          gradient.addColorStop(0.6, `rgba(66, 66, 66, ${0.6 + depthFactor * 0.3})`);
          gradient.addColorStop(1, `rgba(86, 86, 86, ${0.3 + depthFactor * 0.4})`);

          ctx.fillStyle = gradient;
          ctx.beginPath();
          ctx.arc(p.x, p.y, dotSize, 0, Math.PI * 2);
          ctx.fill();

          // Add subtle outer glow for depth - thinner
          ctx.strokeStyle = `rgba(42, 42, 42, ${0.2 + depthFactor * 0.3})`;
          ctx.lineWidth = 0.4;
          ctx.stroke();
        }
      }

      requestAnimationFrame(animate);
    }

    animate();
  })();

  // Reveal on scroll
  const io = new IntersectionObserver(entries=>{
    entries.forEach(e=>{
      if(e.isIntersecting){ e.target.classList.add('in'); io.unobserve(e.target); }
    });
  }, {threshold:.2});
  document.querySelectorAll('.reveal').forEach(el=>io.observe(el));

  // Rotating mission statements
  (function(){
    const missions = [
      "Turn data into decisions through secure, privacy-by-design AI and auditable, high-performance storage.",
      "Empower businesses with trustworthy AIâ€”secured end-to-end, privacy-first, and compliant by designâ€”running on resilient, high-performance storage.",
      "Deliver practical AI with uncompromising security, data protection, and built-in complianceâ€”backed by enterprise-grade storage.",
      "Make AI safe to adopt: secure-by-default, compliant-from-day-one, and powered by unbreakable storage.",
      "Build outcomes, not riskâ€”governed AI on resilient storage with privacy, security, and compliance at the core.",
      "Ship AI you can trust: encrypted, governed, and audit-ready on a rock-solid storage backbone."

      ,"AI-first venture builder obsessed with making artificial intelligence useful, secure, and compliant, not just shiny."
      ,"The name Viable Core Business isnt just a motivational posterits a philosophy. Every product has to make sense commercially, legally, and ethically."
      ,"By pioneering the use of multi-skill fine-tuning on a premier, long-context foundation model, VCB has created a uniquely powerful and trustworthy tool for the legal profession."];

    const element = document.getElementById('rotating-mission');
    if(!element) return;

    let currentIndex = 0;

    function rotateMission(){
      // Fade out
      element.classList.add('fade-out');

      // After fade out, change text and fade in
      setTimeout(() => {
        currentIndex = (currentIndex + 1) % missions.length;
        element.textContent = missions[currentIndex];
        element.classList.remove('fade-out');
      }, 800); // Match CSS transition duration
    }

    // Rotate every 6 seconds
    setInterval(rotateMission, 6000);
  })();

  // ============================================================================
  // VIDEO MODAL - Meet VCB Introduction
  // ============================================================================
  (function(){
    const videoModal = document.getElementById('videoModal');
    const meetVCBBtn = document.getElementById('meetVCBBtn');
    const closeVideoBtn = document.getElementById('closeVideoModal');
    const vcbVideo = document.getElementById('vcbVideo');
    const playHint = document.getElementById('playHint');

    if(!videoModal || !meetVCBBtn || !closeVideoBtn || !vcbVideo) return;

    // Force transparency on video and container
    const videoContent = document.querySelector('.video-modal-content');
    vcbVideo.style.backgroundColor = 'transparent';
    vcbVideo.style.background = 'none';
    if(videoContent) {
      videoContent.style.backgroundColor = 'transparent';
      videoContent.style.background = 'none';
    }

    // Detect mobile Safari and apply blend mode to remove white background
    const isMobileSafari = /iPhone|iPad|iPod/i.test(navigator.userAgent) &&
                           /Safari/i.test(navigator.userAgent) &&
                           !/CriOS|FxiOS|EdgiOS/i.test(navigator.userAgent);

    if(isMobileSafari) {
      // Use darken blend mode and aggressive filtering to remove white background
      vcbVideo.style.mixBlendMode = 'darken';
      vcbVideo.style.filter = 'brightness(1.15) contrast(1.4) saturate(1.2)';
      // Set a slightly off-white background to help blend
      if(videoContent) {
        videoContent.style.backgroundColor = 'rgba(255, 255, 255, 0.98)';
      }
    }

    // Enable dragging of the video modal content
    (function enableVideoDrag(){
      if(!videoContent) return;
      let dragging = false;
      let moved = false;
      let startX = 0, startY = 0;
      let offsetX = 0, offsetY = 0; // accumulated translation

      function setTransform(x, y){
        videoContent.style.transform = `translate(${x}px, ${y}px)`;
      }

      function onPointerDown(e){
        const isClose = e.target && e.target.closest && e.target.closest('#closeVideoModal');
        if (isClose) return;
        dragging = true; moved = false;
        videoContent.classList.add('dragging');
        const p = (e.touches && e.touches[0]) || e;
        startX = p.clientX - offsetX;
        startY = p.clientY - offsetY;
        document.body.style.userSelect = 'none';
      }
      function onPointerMove(e){
        if(!dragging) return;
        const p = (e.touches && e.touches[0]) || e;
        const x = p.clientX - startX;
        const y = p.clientY - startY;
        if (!moved && (Math.abs(x - offsetX) > 3 || Math.abs(y - offsetY) > 3)) moved = true;
        offsetX = x; offsetY = y;
        setTransform(offsetX, offsetY);
        if (e.cancelable) e.preventDefault();
      }
      function onPointerUp(){
        if(!dragging) return;
        dragging = false;
        videoContent.classList.remove('dragging');
        document.body.style.userSelect = '';
      }

      // Mouse
      videoContent.addEventListener('mousedown', onPointerDown);
      window.addEventListener('mousemove', onPointerMove);
      window.addEventListener('mouseup', onPointerUp);
      // Touch
      videoContent.addEventListener('touchstart', onPointerDown, { passive:true });
      window.addEventListener('touchmove', onPointerMove, { passive:false });
      window.addEventListener('touchend', onPointerUp);

      // Prevent click-to-play if the pointer moved
      vcbVideo.addEventListener('click', function(ev){
        if (moved) { ev.stopPropagation(); ev.preventDefault(); moved = false; }
      }, true);

      // Expose a reset helper
      videoModal.__resetVideoDrag = function(){ offsetX = 0; offsetY = 0; setTransform(0,0); };
      videoModal.__resetVideoDrag();
    })();

    // Open video modal
    meetVCBBtn.addEventListener('click', async () => {
      videoModal.classList.add('active');
      document.body.style.overflow = 'hidden';

      // Force transparency again on open
      vcbVideo.style.backgroundColor = 'transparent';
      vcbVideo.style.background = 'none';
      if(videoContent) {
        videoContent.style.backgroundColor = 'transparent';
        videoContent.style.background = 'none';
        if (typeof videoModal.__resetVideoDrag === 'function') videoModal.__resetVideoDrag();

        // Position the video to the right of the Meet VCB button
        try {
          const margin = 12;
          const btnRect = meetVCBBtn.getBoundingClientRect();
          const place = () => {
            const popRect = videoContent.getBoundingClientRect();
            let left = btnRect.right + margin;
            let top  = btnRect.top + (btnRect.height / 2) - (popRect.height / 2);
            // Clamp within viewport
            left = Math.max(8, Math.min(left, window.innerWidth - popRect.width - 8));
            top  = Math.max(8, Math.min(top,  window.innerHeight - popRect.height - 8));
            videoContent.style.position = 'fixed';
            videoContent.style.left = left + 'px';
            videoContent.style.top = top + 'px';
            videoContent.style.right = 'auto';
            videoContent.style.bottom = 'auto';
            videoContent.style.transform = 'translate(0,0)';
          };
          // After layout
          requestAnimationFrame(place);
          // Reposition on resize while open
          const onResize = () => { if (videoModal.classList.contains('active')) place(); };
          window.addEventListener('resize', onResize, { once: true });
        } catch(_) {}
      }

      // Reset and play video
      vcbVideo.currentTime = 0;
      vcbVideo.muted = true;
      try {
        await vcbVideo.play();
        setTimeout(() => {
          vcbVideo.muted = false;
        }, 100);
      } catch(err) {
        console.error('Video play failed:', err);
        if(playHint) playHint.style.display = 'block';
      }
    });

    // Close video modal
    function closeVideoModal(){
      videoModal.classList.remove('active');
      vcbVideo.pause();
      vcbVideo.currentTime = 0;
      document.body.style.overflow = '';
      if (typeof videoModal.__resetVideoDrag === 'function') videoModal.__resetVideoDrag();
    }

    closeVideoBtn.addEventListener('click', closeVideoModal);

    // Click video to pause/play
    vcbVideo.addEventListener('click', (e) => {
      e.stopPropagation();
      if(playHint) playHint.style.display = 'none';
      if(vcbVideo.paused){
        vcbVideo.muted = false;
        vcbVideo.play().catch(err => console.warn('Play failed', err));
      } else {
        vcbVideo.pause();
      }
    });

    // Close on background click
    videoModal.addEventListener('click', (e) => {
      if(e.target === videoModal) closeVideoModal();
    });

    // Close on Escape key
    document.addEventListener('keydown', (e) => {
      if(e.key === 'Escape' && videoModal.classList.contains('active')){
        closeVideoModal();
      }
    });
  })();

  // ============================================================================
  // SARAH VOICE CHAT - Vercel Deployed Integration
  // ============================================================================
  // The voice modal now loads the Vercel-deployed voice application in an iframe
  // Deployment: https://vcbmain.vercel.app
  // Status: Ready
  // ============================================================================

  (function(){
    const floatBtn = document.getElementById('sarahFloatBtn');
    const modal = document.getElementById('voiceModal');
    const closeBtn = document.getElementById('closeModal');
    const loadingOverlay = document.getElementById('voiceLoadingOverlay');

    function setSpinnerPlayState(state){
      if(!loadingOverlay) return;
      loadingOverlay.querySelectorAll('.spinner-ring, .spinner-core, .spinner-icon').forEach(el => {
        el.style.animationPlayState = state;
      });
    }

    if(!floatBtn || !modal) return;

    // Store permission state globally
    window.micPermissionGranted = false;

    // DO NOT open modal here - permission and modal opening happens in Rapport init handler below

    // Hide loading overlay
    function hideLoading(){
      if(loadingOverlay){
        loadingOverlay.classList.add('voice-loading-hidden');
        loadingOverlay.classList.remove('spinner-paused');
      }
      setSpinnerPlayState('running');
    }

    function showLoading(){
      if(loadingOverlay){
        loadingOverlay.classList.remove('voice-loading-hidden', 'spinner-paused');
      }
      setSpinnerPlayState('running');
    }

    function keepSpinnerActive(){
      if(loadingOverlay){
        loadingOverlay.classList.remove('spinner-paused');
      }
      setSpinnerPlayState('running');
    }
    // Close modal and end Rapport session
    function closeModal(){
      hideLoading();
      modal.classList.remove('active');

      // End the Rapport session by removing and recreating the scene
      const sceneContainer = document.querySelector('rapport-scene');
      if (sceneContainer && sceneContainer.parentNode) {
        const parent = sceneContainer.parentNode;
        const newScene = document.createElement('rapport-scene');
        newScene.setAttribute('project-token', 'eec9c8d2-eb1c-47c2-bdda-ab8bbbb7ffbe');
        newScene.setAttribute('style', 'width: 50px; height: 50px; max-width: none; max-height: none; background: transparent; image-rendering: -webkit-optimize-contrast; image-rendering: crisp-edges;');
        parent.replaceChild(newScene, sceneContainer);

        // Reset the initialization flag
        if (typeof window.resetRapport === 'function') {
          window.resetRapport();
        }
      }
    }

    closeBtn.addEventListener('click', closeModal);

    // Make modal draggable
    let isDragging = false;
    let hasMoved = false;
    let currentX;
    let currentY;
    let initialX;
    let initialY;
    let startX;
    let startY;
    let xOffset = 0;
    let yOffset = 0;
    const dragThreshold = 5; // pixels movement to count as drag

    const modalContent = document.querySelector('.voice-modal > div');

    modalContent.addEventListener('mousedown', dragStart);
    document.addEventListener('mousemove', drag);
    document.addEventListener('mouseup', dragEnd);

    // Touch events for mobile (passive: false for preventDefault support)
    modalContent.addEventListener('touchstart', dragStart, { passive: false });
    document.addEventListener('touchmove', drag, { passive: false });
    document.addEventListener('touchend', dragEnd);

    function dragStart(e) {
      // Don't drag if clicking the close button or rapport-scene
      if (e.target.closest('.voice-modal-close') || e.target.closest('rapport-scene')) {
        return;
      }

      if (e.type === 'touchstart') {
        initialX = e.touches[0].clientX - xOffset;
        initialY = e.touches[0].clientY - yOffset;
        startX = e.touches[0].clientX;
        startY = e.touches[0].clientY;
      } else {
        initialX = e.clientX - xOffset;
        initialY = e.clientY - yOffset;
        startX = e.clientX;
        startY = e.clientY;
      }

      // Allow dragging from the modal content
      isDragging = true;
      hasMoved = false;
      modalContent.style.cursor = 'grabbing';
    }

    function drag(e) {
      if (isDragging) {
        let clientX, clientY;

        if (e.type === 'touchmove') {
          clientX = e.touches[0].clientX;
          clientY = e.touches[0].clientY;
        } else {
          clientX = e.clientX;
          clientY = e.clientY;
        }

        // Check if movement exceeds threshold
        const deltaX = Math.abs(clientX - startX);
        const deltaY = Math.abs(clientY - startY);

        if (deltaX > dragThreshold || deltaY > dragThreshold) {
          hasMoved = true;
          e.preventDefault();

          if (e.type === 'touchmove') {
            currentX = e.touches[0].clientX - initialX;
            currentY = e.touches[0].clientY - initialY;
          } else {
            currentX = clientX - initialX;
            currentY = clientY - initialY;
          }

          xOffset = currentX;
          yOffset = currentY;

          setTranslate(currentX, currentY, modalContent);
        }
      }
    }

    function dragEnd(e) {
      if (isDragging && !hasMoved) {
        // It was a click, not a drag - clicks on iframe still work due to pointer-events
      }

      initialX = currentX;
      initialY = currentY;
      isDragging = false;
      hasMoved = false;
      modalContent.style.cursor = 'grab';
    }

    function setTranslate(xPos, yPos, el) {
      el.style.transform = `translate(${xPos}px, ${yPos}px)`;
    }

    // Set initial cursor
    modalContent.style.cursor = 'grab';

    // Don't close on Escape - user can browse while talking
    // Remove escape key handler completely

    window.showVoiceLoading = showLoading;
    window.hideVoiceLoading = hideLoading;
    window.keepVoiceSpinnerActive = keepSpinnerActive;
    window.closeVoiceModal = closeModal;
  })();
</script>

<!-- Rapport Cloud SDK -->
<script src="https://cdn.rapport.cloud/rapport-web-viewer/rapport.js"></script>
<script>
  // Initialize Rapport Scene when modal opens
  (function(){
    // Global flag to track Rapport initialization
    window.rapportInitialized = false;

    // Globally enforce iframe permission policy for microphone/camera/autoplay (helps Safari/iOS)
    (function enforceIframeAllow(){
      try{
        const ALLOW_VAL = 'microphone; camera; autoplay';
        const apply = (iframe) => {
          if(!iframe) return;
          try{ iframe.setAttribute('allow', ALLOW_VAL); }catch{}
          try{ iframe.allow = ALLOW_VAL; }catch{}
          try{ iframe.setAttribute('allowusermedia','true'); }catch{}
          try{ iframe.setAttribute('playsinline',''); }catch{}
          try{ iframe.setAttribute('muted',''); }catch{}
        };
        const scan = () => document.querySelectorAll('iframe').forEach(apply);
        const mo = new MutationObserver((muts)=>{
          for(const m of muts){
            m.addedNodes && m.addedNodes.forEach((n)=>{
              if(n && n.tagName === 'IFRAME') apply(n);
              else if(n && n.querySelectorAll) n.querySelectorAll('iframe').forEach(apply);
            });
          }
        });
        mo.observe(document.documentElement, { childList:true, subtree:true });
        scan();
      }catch(e){ console.warn('enforceIframeAllow failed', e); }
    })();

    const floatBtn = document.getElementById('sarahFloatBtn');
    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent) ||
                     (navigator.maxTouchPoints && navigator.maxTouchPoints > 2);

    if (floatBtn) {
      floatBtn.addEventListener('click', async () => {
        // Open modal first to show loading spinner
        const modal = document.getElementById('voiceModal');
        if (modal) {
          modal.classList.add('active');
        }
        if (typeof window.showVoiceLoading === 'function') {
          window.showVoiceLoading();
        }

        if (!window.rapportInitialized) {
          // Unlock WebAudio on mobile Safari/Chrome to allow the viewer to start audio in the same gesture
          try {
            const AC = window.AudioContext || window.webkitAudioContext;
            if (AC) {
              if (!window.__vcbAudioCtx) window.__vcbAudioCtx = new AC();
              if (window.__vcbAudioCtx.state === 'suspended' && window.__vcbAudioCtx.resume) {
                window.__vcbAudioCtx.resume();
              }
            }
          } catch(e) { console.warn('AudioContext unlock failed', e); }
          // global fallback to ensure spinner is cleared if connection callbacks never arrive (mobile)
          try { if (window.__vcbSpinnerFallback) clearTimeout(window.__vcbSpinnerFallback); } catch {}
          window.__vcbSpinnerFallback = setTimeout(() => {
            if (typeof window.hideVoiceLoading === 'function') {
              window.hideVoiceLoading();
            }
          }, 12000);

          const startRapportSession = () => {
            const scene = document.querySelector('rapport-scene');
            if (scene && typeof scene.sessionRequest === 'function') {
              try {
                // Ensure underlying iframe (if any) is permitted to access microphone/autoplay (Safari/iOS)
                (function allowRapportIframe(el){
                  try {
                    const apply = (iframe) => {
                      if (!iframe) return;
                      const allowVal = "microphone *; camera *; autoplay *";
                      iframe.setAttribute('allow', allowVal);
                      iframe.setAttribute('playsinline', '');
                      iframe.setAttribute('muted', '');
                      // Some browsers read .allow property
                      try { iframe.allow = allowVal; } catch {}
                    };
                    // Direct child iframe
                    if (el.querySelector) apply(el.querySelector('iframe'));
                    // Shadow DOM iframe
                    if (el.shadowRoot) {
                      apply(el.shadowRoot.querySelector('iframe'));
                      const mo = new MutationObserver((mutations) => {
                        for (const m of mutations) {
                          m.addedNodes && m.addedNodes.forEach((n)=>{
                            if (n && n.tagName === 'IFRAME') apply(n);
                            else if (n && n.querySelector) apply(n.querySelector('iframe'));
                          });
                        }
                      });
                      try { mo.observe(el.shadowRoot, { childList: true, subtree: true }); el.__rapportAllowMO = mo; } catch {}
                    }
                  } catch (e) { console.warn('allowRapportIframe failed', e); }
                })(scene);
                scene.sessionRequest({
                  sessionConnected() {
                    // mark initialized on real connect
                    window.rapportInitialized = true;
                    // clear any spinner fallback timer
                    try { if (window.__vcbSpinnerFallback) { clearTimeout(window.__vcbSpinnerFallback); window.__vcbSpinnerFallback = null; } } catch {}
                    if (typeof window.keepVoiceSpinnerActive === 'function') { window.keepVoiceSpinnerActive(); }
                    // Hide loading overlay after 2 second delay
                    setTimeout(() => {
                      if (typeof window.hideVoiceLoading === 'function') { window.hideVoiceLoading(); }
                    }, 2000);

                    // Hide Rapport badge in shadow DOM
                    try {
                      const scene = document.querySelector('rapport-scene');
                      if (scene && scene.shadowRoot) {
                        const style = document.createElement('style');
                        style.textContent = `
                          [part="badge"] {
                            display: none !important;
                            opacity: 0 !important;
                            visibility: hidden !important;
                          }
                        `;
                        scene.shadowRoot.appendChild(style);
                      }
                    } catch (e) { console.warn('Badge hide failed', e); }
                  },
                  sessionError(error) {
                    console.error('Rapport session error', error);
                    try { if (window.__vcbSpinnerFallback) { clearTimeout(window.__vcbSpinnerFallback); window.__vcbSpinnerFallback = null; } } catch {}
                    window.rapportInitialized = false;
                    if (typeof window.hideVoiceLoading === 'function') {
                      window.hideVoiceLoading();
                    }
                    // If session fails (likely permission denied), close modal and alert
                    if (typeof window.closeVoiceModal === 'function') {
                      window.closeVoiceModal();
                    } else {
                      const modal = document.getElementById('voiceModal');
                      if (modal) modal.classList.remove('active');
                    }
                    const message = (error && error.name === 'NotAllowedError')
                      ? 'Microphone access was blocked. Please enable it in your browser settings and try again.'
                      : 'Unable to connect voice chat. Please ensure microphone permissions are enabled and try again.';
                    alert(message);
                  }
                });
              } catch (err) {
                console.error('Rapport initialization failed', err);
                try { if (window.__vcbSpinnerFallback) { clearTimeout(window.__vcbSpinnerFallback); window.__vcbSpinnerFallback = null; } } catch {}
                window.rapportInitialized = false;
                if (typeof window.hideVoiceLoading === 'function') {
                  window.hideVoiceLoading();
                }
                // Rapport initialization failed
                if (typeof window.closeVoiceModal === 'function') {
                  window.closeVoiceModal();
                } else {
                  const modal = document.getElementById('voiceModal');
                  if (modal) modal.classList.remove('active');
                }
                alert('Voice chat failed to initialize. Please try again.');
              }
            }
          };

          // Safari/iOS: preflight mic to stabilize RAPPORT permission handoff; others call directly
          const ua = navigator.userAgent || '';
          const isSafari = /safari/i.test(ua) && !/chrome|crios|android|fxios|firefox|edg/i.test(ua);
          if (isSafari && navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
            try {
              const p = navigator.mediaDevices.getUserMedia({ audio: true });
              p.then(stream => { try { stream.getTracks().forEach(t => t.stop()); } catch {} startRapportSession(); })
               .catch(e => { console.warn('Safari preflight getUserMedia failed', e); startRapportSession(); });
            } catch (e) {
              console.warn('Safari preflight threw', e); startRapportSession();
            }
          } else {
            startRapportSession();
          }
        }
      });
    }
  })();

  // Reset Rapport when modal closes
  window.resetRapport = function() {
    window.rapportInitialized = false;
  };

  // Rapport scene ready
</script>
</body>
</html>




